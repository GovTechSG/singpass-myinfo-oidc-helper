{"version":3,"sources":["../webpack/bootstrap","../external \"lodash\"",".././src/myinfo/fake/profiles/fake-profile.ts",".././src/myinfo/fake/profiles/mrSGDaddyPerfect.ts",".././src/myinfo/domain/map.ts",".././src/myinfo/fake/profiles/childbirthRecords.ts",".././src/myinfo/helper/myinfo-request.ts",".././src/util/index.ts","../external \"querystring\"",".././src/util/JweUtil.ts",".././src/client/index.ts",".././src/myinfo/fake/profiles/fake-profiles.ts","../external \"moment\"",".././src/myinfo/fake/profiles/common.ts",".././src/myinfo/domain/index.ts",".././src/index.ts",".././src/myinfo/index.ts",".././src/myinfo/helper/index.ts",".././src/myinfo/helper/myinfo-helper.ts","../external \"nonce\"",".././src/util/ConfigUtils.ts",".././src/util/StringUtil.ts","../external \"is-base64\"",".././src/util/JestUtil.ts",".././src/util/SigningUtil.ts","../external \"crypto\"","../external \"node-jose\"","../external \"axios-https-proxy-fix\"","../external \"url\"",".././src/util/RedactorUtil.ts",".././src/myinfo/fake/index.ts",".././src/myinfo/fake/fake-helper.ts",".././src/myinfo/fake/profiles/mrPRDaddyPerfect.ts",".././src/myinfo/fake/profiles/mrSGDaddyChildIsOld.ts",".././src/myinfo/fake/profiles/mrSGDaddyChildNone.ts",".././src/myinfo/fake/profiles/mrSGDaddyLongNames.ts",".././src/myinfo/fake/profiles/mrSGDaddyManyChildren.ts",".././src/myinfo/fake/profiles/mrSGPreschoolRegister.ts",".././src/myinfo/fake/profiles/mrSGDaddyMissingFields.ts",".././src/myinfo/fake/profiles/mrSGDaddyMissingUneditableFields.ts",".././src/myinfo/fake/profiles/mrPRDaddyOneChild.ts",".././src/myinfo/fake/profiles/mrsMYMommyPerfect.ts",".././src/myinfo/fake/profiles/mrsSGMommyPerfect.ts",".././src/myinfo/fake/profiles/mrMYDaddyPerfect.ts",".././src/myinfo/fake/fake-request.ts",".././src/singpass/index.ts",".././src/singpass/singpass-helper.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","ProfileArchetype","_","MR_SG_DADDY_PERFECT","mrSGDaddyPerfect","id","generate","profileName","isEmpty","edulevel","lastupdated","code","source","classification","desc","dialect","occupation","regadd","country","unit","street","block","postal","floor","type","building","mobileno","areacode","prefix","nbr","passportexpirydate","divorcedate","marriagecertno","merdekagen","eligibility","quantum","message","gstvoucher","gstregular","year","exclusion","gstmedisave","gstspecial","signup","email","birthcountry","race","silversupport","amount","countryofmarriage","sex","marriagedate","residentialstatus","passportnumber","marital","aliasname","childrenbirthrecords","lifestatus","tob","birthcertno","hanyupinyinname","hanyupinyinaliasname","marriedname","dob","secondaryrace","nationality","lodash_1","generateTwoWayMap","codeToDesc","descToCode","invert","map","F","M","U","comstatus","Y","N","A","D","validity","V","E","I","hdbtype","111","112","113","114","115","116","118","C","P","housingtype","121","122","123","131","132","139","1","2","3","5","0","4","6","7","8","9","passtype","RPass","SPass","P1Pass","P2Pass","QPass","PEP","WHP","TEP","Entre","DP","LTVP","LOC","MWP","status","moment","formatDateToString","date","format","toString","childYoungest","child1MonthOld","subtract","child2MonthsOld","childMiddle1","childMiddle2","childMiddle3","childMiddle4","childMiddle5","childSuperOld","child6YearsOld","startOf","child7YearsOld","endOf","ChildrenRecords","nonceFactory","util_1","client_1","MyInfoRequest","props","this","axiosClient","createClient","timeout","appId","privateKeyContent","privateKeyToSignRequest","privateKeyPassword","uri","queryParams","nonce","timestamp","Date","getTime","authHeader","SigningUtil","generateMyInfoAuthorizationHeader","HttpMethod","GET","requestConfig","params","headers","Authorization","_a","sent","ConfigUtils","StringUtil","JestUtil","JweUtil","jose","decryptJWE","jwe","decryptKey","Error","JWK","asKey","JWE","createDecrypt","algorithms","decrypt","verifyJWS","jws","verifyCert","jwsKey","JWS","createVerify","verify","axios_https_proxy_fix_1","url","RedactorUtil_1","proxyConfig","getProxyConfig","__assign","proxy","instance","default","addRequestLogs","addResponseLogs","proxyUrl","process","env","HTTPS_PROXY","https_proxy","HTTP_PROXY","http_proxy","parsed","parse","auth","split","username","password","host","hostname","port","parseInt","interceptors","request","use","log","method","redactNricfinInString","error","Promise","reject","response","config","optionalParams","_i","arguments","length","console","mrPRDaddyPerfect_1","mrSGDaddyChildIsOld_1","mrSGDaddyChildNone_1","mrSGDaddyLongNames_1","mrSGDaddyManyChildren_1","mrSGPreschoolRegister_1","mrSGDaddyMissingFields_1","mrSGDaddyMissingUneditableFields_1","mrPRDaddyOneChild_1","mrSGDaddyPerfect_1","mrsMYMommyPerfect_1","mrsSGMommyPerfect_1","mrMYDaddyPerfect_1","profiles","mrsSGMommyPerfect","mrPRDaddyPerfect","mrsMYMommyPerfect","mrSGDaddyChildNone","mrPRDaddyOneChild","mrSGDaddyChildIsOld","mrSGDaddyManyChildren","mrPreschoolRegister","mrSGDaddyLongNames","mrSGDaddyMissingFields","mrSGDaddyMissingUneditableFields","mrMYDaddyPerfect","unavailableField","unavailable","domain","domainMap","MyInfo","Singpass","helper_1","Helper","MyInfoHelper","Request","Fake","__export","myinfo_request_1","JweUtil_1","_this","getPersonBasic","uinfin","__awaiter","personBasicURL","client_id","clientID","sp_esvcId","singpassEserviceID","attributes","join","myInfoRequest","error_1","encryptedPersonJWE","data","keyToDecryptJWE","JSON","payload","certToVerifyJWS","verifiedJws","personData","error_2","requestProps","displayWarnings","getValueFromEnv","defaultValue","trim","warn","disableMissingEnvWarnings","getValueFromEnvWithoutWarn","getIntValueFromEnv","stringValue","intValue","isNaN","getBooleanValueFromEnv","isBase64","replaceLineBreaks","input","replace","isBase64Valid","test","paddingRequired","isTest","global","describe","it","qs","crypto","signingKey","signingKeyPassphrase","nonceValue","signature","generateAuthHeaderString","keyPassphrase","baseParams","merge","sortedParams","reduce","prop","set","baseParamsStr","unescape","stringify","baseString","toUpperCase","signWith","createSign","update","sign","generateSignature","app_id","signature_method","indexOfNric","getIndexOfNricInString","nric","substr","redactedNric","redactNricfin","nricfin","isValidNricfin","firstThreeDigits","substring","exec","result","index","fake_helper_1","FakeMyInfoHelper","fake_request_1","FakeMyInfoRequest","fake_profile_1","fake_profiles_1","domain_1","mockParams","mockProfile","find","profile","archetype","person","attrs","myinfoPerson","occupationfreeform","Set","toPairs","filter","k","has","accumulator","v","_b","map_1","MR_PR_DADDY_PERFECT","childbirthRecords_1","MR_SG_DADDY_CHILD_IS_OLD","MR_SG_DADDY_CHILD_NONE","MR_SG_DADDY_LONG_NAMES","longName","values","MR_SG_DADDY_MANY_CHILDREN","MR_SG_PRESCHOOL_CHILDREN","c1","c2","c3","c4","c5","c6","common_1","MR_SG_DADDY_MISSING_FIELDS","homeno","slice","MR_SG_DADDY_MISSING_UNEDITABLE_FIELDS","MR_PR_DADDY_ONE_CHILD","MRS_MY_MOMMY_PERFECT","MRS_SG_MOMMY_PERFECT","MR_MY_DADDY_PERFECT","expectedResponse","postForm","SessionRefreshResult","SessionLogoutResult","querystringUtil","OidcHelper","SINGPASS_SESSION_COOKIE_NAME","constructAuthorizationUrl","state","redirect_uri","redirectUri","scope","response_type","queryString","authorizationUrl","getTokens","authCode","axiosRequestConfig","grant_type","client_secret","clientSecret","body","content-type","post","tokenUrl","id_token","_testExports","singpassClient","logoutUrl","jweDecryptKey","jwsVerifyKey","getIdTokenPayload","tokens","decryptedJwe","jwsPayload","e_1","extractNricAndUuidFromPayload","sub","matchResult","match","uuid","refreshSession","sessionId","Cookie","res","responseUrl","includes","INVALID_SESSION_ID","SUCCESS","e_2","SINGPASS_ERROR","logoutOfSession","e_3"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","module.exports = require(\"lodash\");","import { domain } from \"../../domain\";\n\nexport interface FakeProfile {\n\tid: string;\n\tname: ProfileArchetype;\n\tgenerate: (profileName?: string) => domain.Components.Schemas.PersonBasic;\n}\n\n/**\n * Used in MyInfo.Fake.Helper.getPersonData to get a archetype person\n */\nexport enum ProfileArchetype {\n\tMR_PR_DADDY_ONE_CHILD = \"Mr PR Daddy with One Child\",\n\tMR_PR_DADDY_PERFECT = \"Mr PR Daddy Perfect\",\n\tMR_SG_DADDY_CHILD_IS_OLD = \"Mr SG with 1 old child\",\n\tMR_SG_DADDY_CHILD_NONE = \"Mr SG with no children\",\n\tMR_SG_DADDY_LONG_NAMES = \"Mr SG daddy with long names\",\n\tMR_SG_DADDY_MANY_CHILDREN = \"Mr SG with many children\",\n\tMR_SG_DADDY_MISSING_FIELDS = \"Mr SG Daddy Missing Fields\",\n\tMR_SG_DADDY_MISSING_UNEDITABLE_FIELDS = \"Mr SG Daddy Missing Uneditable Fields\",\n\tMR_SG_DADDY_PERFECT = \"Mr SG Daddy Perfect\",\n\tMR_SG_PRESCHOOL_CHILDREN = \"Mr SG Preschool Children\",\n\tMRS_MY_MOMMY_PERFECT = \"Mrs MY Mommy Perfect\",\n\tMRS_SG_MOMMY_PERFECT = \"Mrs SG Mommy Perfect\",\n\tMR_MY_DADDY_PERFECT = \"Mr MY Daddy Perfect\",\n}\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\n\n\nconst id = \"S8399420G\";\nconst name = ProfileArchetype.MR_SG_DADDY_PERFECT;\n\nexport const mrSGDaddyPerfect: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\treturn {\n\t\t\t\"edulevel\": {\n\t\t\t\t\"lastupdated\": \"2018-05-10\",\n\t\t\t\t\"code\": \"8\",\n\t\t\t\t\"source\": \"2\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)\",\n\t\t\t},\n\t\t\t\"dialect\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"HK\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"HOKKIEN\",\n\t\t\t},\n\t\t\t\"occupation\": {\n\t\t\t\t\"lastupdated\": \"2018-05-21\",\n\t\t\t\t\"code\": \"11110\",\n\t\t\t\t\"source\": \"2\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"LEGISLATOR\",\n\t\t\t},\n\t\t\t\"regadd\": {\n\t\t\t\t\"country\": {\n\t\t\t\t\t\"code\": \"SG\",\n\t\t\t\t\t\"desc\": \"SINGAPORE\",\n\t\t\t\t},\n\t\t\t\t\"unit\": {\n\t\t\t\t\t\"value\": \"22\",\n\t\t\t\t},\n\t\t\t\t\"street\": {\n\t\t\t\t\t\"value\": \"TOA PAYOH LORONG 1\",\n\t\t\t\t},\n\t\t\t\t\"lastupdated\": \"2018-05-10\",\n\t\t\t\t\"block\": {\n\t\t\t\t\t\"value\": \"123\",\n\t\t\t\t},\n\t\t\t\t\"postal\": {\n\t\t\t\t\t\"value\": \"310123\",\n\t\t\t\t},\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"floor\": {\n\t\t\t\t\t\"value\": \"12\",\n\t\t\t\t},\n\t\t\t\t\"type\": \"SG\",\n\t\t\t\t\"building\": {\n\t\t\t\t\t\"value\": \"\",\n\t\t\t\t},\n\t\t\t},\n\t\t\t\"mobileno\": {\n\t\t\t\t\"lastupdated\": \"2019-04-03\",\n\t\t\t\t\"source\": \"4\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"areacode\": {\n\t\t\t\t\t\"value\": \"65\",\n\t\t\t\t},\n\t\t\t\t\"prefix\": {\n\t\t\t\t\t\"value\": \"+\",\n\t\t\t\t},\n\t\t\t\t\"nbr\": {\n\t\t\t\t\t\"value\": \"97399245\",\n\t\t\t\t},\n\t\t\t},\n\t\t\t\"passportexpirydate\": {\n\t\t\t\t\"lastupdated\": \"\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"\",\n\t\t\t},\n\t\t\t\"divorcedate\": {\n\t\t\t\t\"lastupdated\": \"\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"\",\n\t\t\t},\n\t\t\t\"marriagecertno\": {\n\t\t\t\t\"lastupdated\": \"2018-05-10\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"M525997\",\n\t\t\t},\n\t\t\t\"merdekagen\": {\n\t\t\t\t\"eligibility\": {\n\t\t\t\t\t\"value\": true,\n\t\t\t\t},\n\t\t\t\t\"lastupdated\": \"2019-04-01\",\n\t\t\t\t\"quantum\": {\n\t\t\t\t\t\"value\": 200,\n\t\t\t\t},\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"message\": {\n\t\t\t\t\t\"code\": 2,\n\t\t\t\t\t\"desc\": \"You are eligible for the Merdeka Generation Package. For further enquiries, please contact 1800-2222-888.\",\n\t\t\t\t},\n\t\t\t},\n\t\t\t\"gstvoucher\": {\n\t\t\t\t\"gstregular\": {\n\t\t\t\t\t\"value\": 300,\n\t\t\t\t},\n\t\t\t\t\"year\": {\n\t\t\t\t\t\"value\": 2018,\n\t\t\t\t},\n\t\t\t\t\"exclusion\": {\n\t\t\t\t\t\"value\": false,\n\t\t\t\t},\n\t\t\t\t\"gstmedisave\": {\n\t\t\t\t\t\"value\": 250,\n\t\t\t\t},\n\t\t\t\t\"lastupdated\": \"2019-04-01\",\n\t\t\t\t\"gstspecial\": {\n\t\t\t\t\t\"value\": 55,\n\t\t\t\t},\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"signup\": {\n\t\t\t\t\t\"value\": true,\n\t\t\t\t},\n\t\t\t},\n\t\t\t\"email\": {\n\t\t\t\t\"lastupdated\": \"2019-04-03\",\n\t\t\t\t\"source\": \"4\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"myinfotesting@gmail.com\",\n\t\t\t},\n\t\t\t\"birthcountry\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"SG\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"SINGAPORE\",\n\t\t\t},\n\t\t\t\"race\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"CN\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"CHINESE\",\n\t\t\t},\n\t\t\t\"silversupport\": {\n\t\t\t\t\"eligibility\": {\n\t\t\t\t\t\"value\": true,\n\t\t\t\t},\n\t\t\t\t\"lastupdated\": \"2019-04-01\",\n\t\t\t\t\"amount\": {\n\t\t\t\t\t\"value\": 300,\n\t\t\t\t},\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"year\": {\n\t\t\t\t\t\"value\": 2019,\n\t\t\t\t},\n\t\t\t},\n\t\t\t\"countryofmarriage\": {\n\t\t\t\t\"lastupdated\": \"2018-05-10\",\n\t\t\t\t\"code\": \"SG\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"SINGAPORE\",\n\t\t\t},\n\t\t\t\"sex\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"M\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"Male\",\n\t\t\t},\n\t\t\t\"marriagedate\": {\n\t\t\t\t\"lastupdated\": \"1993-10-22\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"1993-10-22\",\n\t\t\t},\n\t\t\t\"residentialstatus\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"C\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"Citizen\",\n\t\t\t},\n\t\t\t\"passportnumber\": {\n\t\t\t\t\"lastupdated\": \"\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"\",\n\t\t\t},\n\t\t\t\"marital\": {\n\t\t\t\t\"lastupdated\": \"2018-05-10\",\n\t\t\t\t\"code\": \"2\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"MARRIED\",\n\t\t\t},\n\t\t\t\"aliasname\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"JASCKSON LIM YONG XIANG\",\n\t\t\t},\n\t\t\t\"childrenbirthrecords\": [\n\t\t\t\t{\n\t\t\t\t\t\"dialect\": {\n\t\t\t\t\t\t\"code\": \"HK\",\n\t\t\t\t\t\t\"desc\": \"Hokkien\",\n\t\t\t\t\t},\n\t\t\t\t\t\"race\": {\n\t\t\t\t\t\t\"code\": \"CN\",\n\t\t\t\t\t\t\"desc\": \"Chinese\",\n\t\t\t\t\t},\n\t\t\t\t\t\"lifestatus\": {\n\t\t\t\t\t\t\"code\": \"A\",\n\t\t\t\t\t\t\"desc\": \"ALIVE\",\n\t\t\t\t\t},\n\t\t\t\t\t\"tob\": {\n\t\t\t\t\t\t\"value\": \"0901\",\n\t\t\t\t\t},\n\t\t\t\t\t\"sex\": {\n\t\t\t\t\t\t\"code\": \"F\",\n\t\t\t\t\t\t\"desc\": \"Female\",\n\t\t\t\t\t},\n\t\t\t\t\t\"source\": \"1\",\n\t\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\t\"birthcertno\": {\n\t\t\t\t\t\t\"value\": \"S5562882C\",\n\t\t\t\t\t},\n\t\t\t\t\t\"hanyupinyinname\": {\n\t\t\t\t\t\t\"value\": \"Cheng Pei Ni\",\n\t\t\t\t\t},\n\t\t\t\t\t\"hanyupinyinaliasname\": {\n\t\t\t\t\t\t\"value\": \"\",\n\t\t\t\t\t},\n\t\t\t\t\t\"marriedname\": {\n\t\t\t\t\t\t\"value\": \"\",\n\t\t\t\t\t},\n\t\t\t\t\t\"aliasname\": {\n\t\t\t\t\t\t\"value\": \"\",\n\t\t\t\t\t},\n\t\t\t\t\t\"dob\": {\n\t\t\t\t\t\t\"value\": \"2011-09-10\",\n\t\t\t\t\t},\n\t\t\t\t\t\"name\": {\n\t\t\t\t\t\t\"value\": \"Jo Tan Pei Ni\",\n\t\t\t\t\t},\n\t\t\t\t\t\"lastupdated\": \"2018-05-16\",\n\t\t\t\t\t\"secondaryrace\": {\n\t\t\t\t\t\t\"code\": \"\",\n\t\t\t\t\t\t\"desc\": \"\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\t\"nationality\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"SG\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"SINGAPORE CITIZEN\",\n\t\t\t},\n\t\t\t\"dob\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"1953-10-06\",\n\t\t\t},\n\t\t\t\"name\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"value\": \"LIM YONG XIANG\",\n\t\t\t},\n\t\t\t\"secondaryrace\": {\n\t\t\t\t\"lastupdated\": \"2018-06-01\",\n\t\t\t\t\"code\": \"GM\",\n\t\t\t\t\"source\": \"1\",\n\t\t\t\t\"classification\": \"C\",\n\t\t\t\t\"desc\": \"GERMAN\",\n\t\t\t},\n\t\t};\n\t},\n};\n","import { invert } from \"lodash\";\n\nexport namespace sex {\n\tinterface Code2Desc {\n\t\t\"F\": \"Female\";\n\t\t\"M\": \"Male\";\n\t\t\"U\": \"Unknown\";\n\t}\n\tinterface Desc2Code {\n\t\t\"Female\": \"F\";\n\t\t\"Male\": \"M\";\n\t\t\"Unknown\": \"U\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"F\": \"Female\",\n\t\t\"M\": \"Male\",\n\t\t\"U\": \"Unknown\",\n\t};\n\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace comstatus {\n\tinterface Code2Desc {\n\t\t\"Y\": \"Eligible\";\n\t\t\"N\": \"Not Eligible\";\n\t}\n\tinterface Desc2Code {\n\t\t\"Eligible\": \"Y\";\n\t\t\"Not Eligible\": \"N\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"Y\": \"Eligible\",\n\t\t\"N\": \"Not Eligible\",\n\t};\n\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace lifestatus {\n\n\tinterface Code2Desc {\n\t\t\"A\": \"ALIVE\";\n\t\t\"D\": \"DECEASED\";\n\t}\n\tinterface Desc2Code {\n\t\t\"ALIVE\": \"A\";\n\t\t\"DECEASED\": \"D\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"A\": \"ALIVE\",\n\t\t\"D\": \"DECEASED\",\n\t};\n\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n\n}\n\nexport namespace validity {\n\tinterface Code2Desc {\n\t\t\"V\": \"Valid\";\n\t\t\"E\": \"Expired\";\n\t\t\"I\": \"Invalid\";\n\t\t\"N\": \"Not Holding PDL\";\n\t}\n\tinterface Desc2Code {\n\t\t\"Valid\": \"V\";\n\t\t\"Expired\": \"E\";\n\t\t\"Invalid\": \"I\";\n\t\t\"Not Holding PDL\": \"N\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"V\": \"Valid\",\n\t\t\"E\": \"Expired\",\n\t\t\"I\": \"Invalid\",\n\t\t\"N\": \"Not Holding PDL\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\n\nexport namespace hdbtype {\n\tinterface Code2Desc {\n\t\t\"111\": \"1-ROOM FLAT (HDB)\";\n\t\t\"112\": \"2-ROOM FLAT (HDB)\";\n\t\t\"113\": \"3-ROOM FLAT (HDB)\";\n\t\t\"114\": \"4-ROOM FLAT (HDB)\";\n\t\t\"115\": \"5-ROOM FLAT (HDB)\";\n\t\t\"116\": \"EXECUTIVE FLAT (HDB)\";\n\t\t\"118\": \"STUDIO APARTMENT (HDB)\";\n\t}\n\tinterface Desc2Code {\n\t\t\"1-ROOM FLAT (HDB)\": \"111\";\n\t\t\"2-ROOM FLAT (HDB)\": \"112\";\n\t\t\"3-ROOM FLAT (HDB)\": \"113\";\n\t\t\"4-ROOM FLAT (HDB)\": \"114\";\n\t\t\"5-ROOM FLAT (HDB)\": \"115\";\n\t\t\"EXECUTIVE FLAT (HDB)\": \"116\";\n\t\t\"STUDIO APARTMENT (HDB)\": \"118\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"111\": \"1-ROOM FLAT (HDB)\",\n\t\t\"112\": \"2-ROOM FLAT (HDB)\",\n\t\t\"113\": \"3-ROOM FLAT (HDB)\",\n\t\t\"114\": \"4-ROOM FLAT (HDB)\",\n\t\t\"115\": \"5-ROOM FLAT (HDB)\",\n\t\t\"116\": \"EXECUTIVE FLAT (HDB)\",\n\t\t\"118\": \"STUDIO APARTMENT (HDB)\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace residentialstatus {\n\tinterface Code2Desc {\n\t\t\"A\": \"Alien\";\n\t\t\"C\": \"Citizen\";\n\t\t\"P\": \"PR\";\n\t\t\"U\": \"Unknown\";\n\t\t\"N\": \"NOT APPLICABLE\";\n\t}\n\tinterface Desc2Code {\n\t\t\"Alien\": \"A\";\n\t\t\"Citizen\": \"C\";\n\t\t\"PR\": \"P\";\n\t\t\"Unknown\": \"U\";\n\t\t\"NOT APPLICABLE\": \"N\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"A\": \"Alien\",\n\t\t\"C\": \"Citizen\",\n\t\t\"P\": \"PR\",\n\t\t\"U\": \"Unknown\",\n\t\t\"N\": \"NOT APPLICABLE\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace housingtype {\n\tinterface Code2Desc {\n\t\t\"121\": \"DETACHED HOUSE\";\n\t\t\"122\": \"SEMI-DETACHED HOUSE\";\n\t\t\"123\": \"TERRACE HOUSE\";\n\t\t\"131\": \"CONDOMINIUM\";\n\t\t\"132\": \"EXECUTIVE CONDOMINIUM\";\n\t\t\"139\": \"APARTMENT\";\n\t}\n\n\tinterface Desc2Code {\n\t\t\"DETACHED HOUSE\": \"121\";\n\t\t\"SEMI-DETACHED HOUSE\": \"122\";\n\t\t\"TERRACE HOUSE\": \"123\";\n\t\t\"CONDOMINIUM\": \"131\";\n\t\t\"EXECUTIVE CONDOMINIUM\": \"132\";\n\t\t\"APARTMENT\": \"139\";\n\t}\n\tconst codeToDesc: Code2Desc = {\n\t\t\"121\": \"DETACHED HOUSE\",\n\t\t\"122\": \"SEMI-DETACHED HOUSE\",\n\t\t\"123\": \"TERRACE HOUSE\",\n\t\t\"131\": \"CONDOMINIUM\",\n\t\t\"132\": \"EXECUTIVE CONDOMINIUM\",\n\t\t\"139\": \"APARTMENT\",\n\t};\n\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace marital {\n\tinterface Code2Desc {\n\t\t\"1\": \"SINGLE\";\n\t\t\"2\": \"MARRIED\";\n\t\t\"3\": \"WIDOWED\";\n\t\t\"5\": \"DIVORCED\";\n\t}\n\n\tinterface Desc2Code {\n\t\t\"SINGLE\": \"1\";\n\t\t\"MARRIED\": \"2\";\n\t\t\"WIDOWED\": \"3\";\n\t\t\"DIVORCED\": \"5\";\n\t}\n\tconst codeToDesc: Code2Desc = {\n\t\t\"1\": \"SINGLE\",\n\t\t\"2\": \"MARRIED\",\n\t\t\"3\": \"WIDOWED\",\n\t\t\"5\": \"DIVORCED\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace edulevel {\n\tinterface Code2Desc {\n\t\t\"0\": \"NO FORMAL QUALIFICATION / PRE-PRIMARY / LOWER PRIMARY\";\n\t\t\"1\": \"PRIMARY\";\n\t\t\"2\": \"LOWER SECONDARY\";\n\t\t\"3\": \"SECONDARY\";\n\t\t\"4\": \"POST-SECONDARY (NON-TERTIARY): GENERAL & VOCATION\";\n\t\t\"5\": \"POLYTECHNIC DIPLOMA\";\n\t\t\"6\": \"PROFESSIONAL QUALIFICATION AND OTHER DIPLOMA\";\n\t\t\"7\": \"BACHELOR'S OR EQUIVALENT\";\n\t\t\"8\": \"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)\";\n\t\t\"9\": \"MASTER'S AND DOCTORATE OR EQUIVALENT\";\n\t\t\"N\": \"MODULAR CERTIFICATION (NON-AWARD COURSES / NON-FULL QUALIFICATIONS)\";\n\t}\n\n\tinterface Desc2Code {\n\t\t\"NO FORMAL QUALIFICATION / PRE-PRIMARY / LOWER PRIMARY\": \"0\";\n\t\t\"PRIMARY\": \"1\";\n\t\t\"LOWER SECONDARY\": \"2\";\n\t\t\"SECONDARY\": \"3\";\n\t\t\"POST-SECONDARY (NON-TERTIARY): GENERAL & VOCATION\": \"4\";\n\t\t\"POLYTECHNIC DIPLOMA\": \"5\";\n\t\t\"PROFESSIONAL QUALIFICATION AND OTHER DIPLOMA\": \"6\";\n\t\t\"BACHELOR'S OR EQUIVALENT\": \"7\";\n\t\t\"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)\": \"8\";\n\t\t\"MASTER'S AND DOCTORATE OR EQUIVALENT\": \"9\";\n\t\t\"MODULAR CERTIFICATION (NON-AWARD COURSES / NON-FULL QUALIFICATIONS)\": \"N\";\n\t}\n\tconst codeToDesc: Code2Desc = {\n\t\t\"0\": \"NO FORMAL QUALIFICATION / PRE-PRIMARY / LOWER PRIMARY\",\n\t\t\"1\": \"PRIMARY\",\n\t\t\"2\": \"LOWER SECONDARY\",\n\t\t\"3\": \"SECONDARY\",\n\t\t\"4\": \"POST-SECONDARY (NON-TERTIARY): GENERAL & VOCATION\",\n\t\t\"5\": \"POLYTECHNIC DIPLOMA\",\n\t\t\"6\": \"PROFESSIONAL QUALIFICATION AND OTHER DIPLOMA\",\n\t\t\"7\": \"BACHELOR'S OR EQUIVALENT\",\n\t\t\"8\": \"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)\",\n\t\t\"9\": \"MASTER'S AND DOCTORATE OR EQUIVALENT\",\n\t\t\"N\": \"MODULAR CERTIFICATION (NON-AWARD COURSES / NON-FULL QUALIFICATIONS)\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\nexport namespace passtype {\n\tinterface Code2Desc {\n\t\t\"RPass\": \"Work Permit\";\n\t\t\"SPass\": \"S Pass\";\n\t\t\"P1Pass\": \"Employment Pass\";\n\t\t\"P2Pass\": \"Employment Pass\";\n\t\t\"QPass\": \"Employment Pass\";\n\t\t\"PEP\": \"Personalised Employment Pass\";\n\t\t\"WHP\": \"Work Holiday Pass\";\n\t\t\"TEP\": \"Training Employment Pass\";\n\t\t\"Entre\": \"EntrePass\";\n\t\t\"DP\": \"Dependent Pass\";\n\t\t\"LTVP\": \"Long Term Visit Pass\";\n\t\t\"LOC\": \"Letter of Consent\";\n\t\t\"MWP\": \"Miscellaneous Work Pass\";\n\t}\n\n\tconst codeToDesc: Code2Desc = {\n\t\t\"RPass\": \"Work Permit\",\n\t\t\"SPass\": \"S Pass\",\n\t\t\"P1Pass\": \"Employment Pass\",\n\t\t\"P2Pass\": \"Employment Pass\",\n\t\t\"QPass\": \"Employment Pass\",\n\t\t\"PEP\": \"Personalised Employment Pass\",\n\t\t\"WHP\": \"Work Holiday Pass\",\n\t\t\"TEP\": \"Training Employment Pass\",\n\t\t\"Entre\": \"EntrePass\",\n\t\t\"DP\": \"Dependent Pass\",\n\t\t\"LTVP\": \"Long Term Visit Pass\",\n\t\t\"LOC\": \"Letter of Consent\",\n\t\t\"MWP\": \"Miscellaneous Work Pass\",\n\t};\n\texport const map = { codeToDesc };\n}\n\nexport namespace status {\n\tinterface Code2Desc {\n\t\t\"1\": \"LIVE\";\n\t\t\"2\": \"DE-REGISTERED\";\n\t}\n\n\tinterface Desc2Code {\n\t\t\"LIVE\": \"1\";\n\t\t\"DE-REGISTERED\": \"2\";\n\t}\n\tconst codeToDesc: Code2Desc = {\n\t\t\"1\": \"LIVE\",\n\t\t\"2\": \"DE-REGISTERED\",\n\t};\n\texport const map = generateTwoWayMap<Code2Desc, Desc2Code>(codeToDesc);\n}\n\n/**\n * Generates codeToDesc, which is a key: value map and descToCode, which is an inverse of codeToDesc\n * Assumes value is a string/number and can be used as a inverse key\n * @param codeToDesc\n */\nfunction generateTwoWayMap<Code2DescMap extends object, Desc2CodeMap extends object>(codeToDesc: Code2DescMap): { codeToDesc: Code2DescMap; descToCode: Desc2CodeMap } {\n\treturn {\n\t\tcodeToDesc,\n\t\tdescToCode: invert(codeToDesc) as unknown as Desc2CodeMap,\n\t};\n}\n","import { domain } from \"../../domain\";\nimport * as moment from \"moment\";\n\nconst formatDateToString = (date?: moment.Moment): string => {\n\tif (date) {\n\t\treturn date.format(\"YYYY-MM-DD\").toString();\n\t}\n\treturn moment().format(\"YYYY-MM-DD\").toString();\n};\n\nconst childYoungest = {\n\tbirthcertno: { value: \"T1828432J\" },\n\tname: { value: \"Youngest Tan Ke Xuan\" },\n\tdob: { value: formatDateToString() },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst child1MonthOld = {\n\tbirthcertno: { value: \"T4383608G\" },\n\tname: { value: \"1 Month Tan Ke Yu\" },\n\tdob: { value: formatDateToString(moment().subtract(1, \"months\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst child2MonthsOld = {\n\tbirthcertno: { value: \"T7153144E\" },\n\tname: { value: \"2 Months Tan Keh Guan\" },\n\tdob: { value: formatDateToString(moment().subtract(2, \"months\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childMiddle1 = {\n\tbirthcertno: { value: \"T1694727F\" },\n\tname: { value: \"Middle Tan Twin1\" },\n\tdob: { value: formatDateToString(moment().subtract(2, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childMiddle2 = {\n\tbirthcertno: { value: \"T1669632Z\" },\n\tname: { value: \"Middle Tan Twin2\" },\n\tdob: { value: formatDateToString(moment().subtract(2, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childMiddle3 = {\n\tbirthcertno: { value: \"T1509027D\" },\n\tname: { value: \"Tan Boy\" },\n\tdob: { value: formatDateToString(moment().subtract(3, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childMiddle4 = {\n\tbirthcertno: { value: \"T1422931G\" },\n\tname: { value: \"Tan Girl\" },\n\tdob: { value: formatDateToString(moment().subtract(4, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childMiddle5 = {\n\tbirthcertno: { value: \"T1511326F\" },\n\tname: { value: \"Tan Girl Younger\" },\n\tdob: { value: formatDateToString(moment().subtract(5, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst childSuperOld = {\n\tbirthcertno: { value: \"T0050832I\" },\n\tname: { value: \"Super Old Tan Ke Wei\" },\n\tdob: { value: formatDateToString(moment().subtract(8, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst child6YearsOld = {\n\tbirthcertno: { value: \"T1364674G\" },\n\tname: { value: \"Turning 6 Tan Kid born Jan 1st\" },\n\tdob: { value: formatDateToString(moment().subtract(6, \"years\").startOf(\"year\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nconst child7YearsOld = {\n\tbirthcertno: { value: \"T1210114C\" },\n\tname: { value: \"Turning 7 Tan Kid born Dec 31\" },\n\tdob: { value: formatDateToString(moment().subtract(7, \"years\").endOf(\"year\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\n\nexport const ChildrenRecords = {\n\tchildYoungest,\n\tchild1MonthOld,\n\tchild2MonthsOld,\n\tchildMiddle1,\n\tchildMiddle2,\n\tchildMiddle3,\n\tchildMiddle4,\n\tchildMiddle5,\n\tchildSuperOld,\n\tchild6YearsOld,\n\tchild7YearsOld,\n};\n","import * as nonceFactory from \"nonce\";\nimport { AxiosInstance, AxiosRequestConfig, AxiosResponse } from \"axios-https-proxy-fix\";\nimport { SigningUtil } from \"../../util\";\nimport { createClient } from \"../../client\";\n\nexport interface MyInfoRequestConstructor {\n\tappId: string;\n\tprivateKeyToSignRequest: string;\n\tprivateKeyPassword: string;\n}\n\n/**\n * For most cases, myinfo-helper will suffice.\n * This class is used only for special MyInfo endpoints.\n * Request class for MyInfo endpoints other than those defined in MyInfoHelper\n */\nexport class MyInfoRequest {\n\tprivate readonly axiosClient: AxiosInstance;\n\tprivate readonly appId: string;\n\tprivate readonly privateKeyContent: string;\n\tprivate readonly privateKeyPassword: string;\n\n\tconstructor(props: MyInfoRequestConstructor) {\n\t\tthis.axiosClient = createClient({\n\t\t\ttimeout: 10000,\n\t\t});\n\t\tthis.appId = props.appId;\n\t\tthis.privateKeyContent = props.privateKeyToSignRequest;\n\t\tthis.privateKeyPassword = props.privateKeyPassword;\n\t}\n\n\tpublic async get(\n\t\turi: string,\n\t\tqueryParams?: { [key: string]: any },\n\t): Promise<AxiosResponse> {\n\n\t\tlet authHeader: string = \"\";\n\t\tconst nonce = nonceFactory()();\n\t\tconst timestamp = new Date().getTime();\n\n\t\tauthHeader = SigningUtil.generateMyInfoAuthorizationHeader(\n\t\t\turi,\n\t\t\tqueryParams,\n\t\t\tSigningUtil.HttpMethod.GET,\n\t\t\tthis.appId,\n\t\t\tthis.privateKeyContent,\n\t\t\tnonce,\n\t\t\ttimestamp,\n\t\t\tthis.privateKeyPassword,\n\t\t);\n\n\t\tconst requestConfig: AxiosRequestConfig = {\n\t\t\tparams: queryParams,\n\t\t\theaders: {\n\t\t\t\tAuthorization: authHeader,\n\t\t\t},\n\t\t};\n\t\tconst response = await this.axiosClient.get(uri, requestConfig);\n\t\treturn response;\n\t}\n\n}\n","import * as ConfigUtils from \"./ConfigUtils\";\nimport * as StringUtil from \"./StringUtil\";\nimport * as JestUtil from \"./JestUtil\";\nimport * as SigningUtil from \"./SigningUtil\";\nimport * as JweUtil from \"./JweUtil\";\n\nexport { ConfigUtils, StringUtil, JestUtil, SigningUtil, JweUtil };\n","module.exports = require(\"querystring\");","import * as jose from \"node-jose\";\n\ninterface JWT {\n\theader:\n\t{\n\t\talg: string;\n\t\tenc: string;\n\t\tkid: string;\n\t\tcty: string;\n\t};\n\tprotected: string[];\n\tpayload: Buffer;\n}\n\nexport interface JWE extends JWT {\n\tplaintext: Buffer;\n}\n\nexport interface JWS extends JWT {\n\tsignature: Buffer;\n}\n\nexport async function decryptJWE(jwe: string, decryptKey: string): Promise<JWE> {\n\tif (!jwe) throw new Error(\"Missing JWE data.\");\n\tif (!decryptKey) throw new Error(\"Missing key to decrypt JWE payload.\");\n\t// TODO: can be further optimized by caching key in memory instead of regenerating each time\n\tconst key = await jose.JWK.asKey(decryptKey, \"pem\");\n\n\t// allow all supported algorithms\n\treturn jose.JWE.createDecrypt(key, { algorithms: [\"*\"] }).decrypt(jwe);\n}\n\nexport async function verifyJWS(jws: string, verifyCert: string): Promise<JWS> {\n\tif (!jws) throw new Error(\"Missing JWS data.\");\n\tif (!verifyCert) throw new Error(\"Missing cert to verify JWS payload.\");\n\n\t// TODO: can be further optimized by caching key in memory instead of regenerating each time\n\tconst jwsKey = await jose.JWK.asKey(verifyCert, \"pem\");\n\n\treturn jose.JWS.createVerify(jwsKey).verify(jws);\n}\n","import axios, { AxiosInstance, AxiosProxyConfig, AxiosRequestConfig } from \"axios-https-proxy-fix\";\nimport * as url from \"url\";\nimport { redactNricfinInString } from \"../util/RedactorUtil\";\n\nexport const createClient = (requestConfig: AxiosRequestConfig = {}): AxiosInstance => {\n\t// Note: Due to axios not being able to automatically pick up proxy env vars\n\t// correctly, we have manually set the proxy config here.\n\t// That alone is not enough to resolve the issue as there is a bug with axios\n\t// where requesting a https endpoint through Nectar's http proxy does not work\n\t// Hence, we have to use a forked library called axios-https-proxy-fix\n\t// Hopefully the next stable release of axios (post 0.18.0) will fix this\n\t// Also to note: tested 0.19.0-beta.1 version of axios and still encountering proxy errors\n\tconst proxyConfig = getProxyConfig();\n\trequestConfig = proxyConfig ?\n\t\t{ proxy: proxyConfig, ...requestConfig }\n\t\t: requestConfig;\n\n\tconst instance = axios.create({\n\t\t...requestConfig,\n\t});\n\n\taddRequestLogs(instance);\n\taddResponseLogs(instance);\n\treturn instance;\n};\n\nconst getProxyConfig = (): AxiosProxyConfig => {\n\tconst proxyUrl = process.env.HTTPS_PROXY || process.env.https_proxy || process.env.HTTP_PROXY || process.env.http_proxy;\n\n\tif (proxyUrl) {\n\t\tconst parsed = url.parse(proxyUrl);\n\t\tconst [username, password] = parsed.auth.split(\":\");\n\t\treturn {\n\t\t\thost: parsed.hostname,\n\t\t\tport: parseInt(parsed.port, 10),\n\t\t\tauth: {\n\t\t\t\tusername,\n\t\t\t\tpassword,\n\t\t\t},\n\t\t};\n\t}\n\n\treturn null;\n};\n\nconst addRequestLogs = (instance: AxiosInstance) => {\n\tinstance.interceptors.request.use((request) => {\n\t\tif (!!request) {\n\t\t\tlog(`Requesting ${request.method} : ${redactNricfinInString(request.url)}`);\n\t\t}\n\t\treturn request;\n\t}, (error) => {\n\t\tlog(`Error occurred while making a request ${error.message}`, error);\n\t\treturn Promise.reject(error);\n\t});\n};\n\nconst addResponseLogs = (instance: AxiosInstance) => {\n\tinstance.interceptors.response.use((response) => {\n\t\tif (!!response) {\n\t\t\tlog(`Responded ${response.config.method}  : ${redactNricfinInString(response.config.url)}`);\n\t\t}\n\t\treturn response;\n\t}, (error) => {\n\t\tif (!!error.response) {\n\t\t\tlog(`Error occurred while responding to request ${error.response.config.method} :\n\t\t\t${redactNricfinInString(error.response.config.url)}`, error);\n\t\t} else {\n\t\t\tlog(`Error occurred while responding to request`, error);\n\t\t}\n\t\treturn Promise.reject(error);\n\t});\n};\n\nconst log = (message?: any, ...optionalParams: any[]) => {\n\t// tslint:disable-next-line:no-console\n\tconsole.log(message, optionalParams);\n};\n","import { mrPRDaddyPerfect } from \"./mrPRDaddyPerfect\";\nimport { mrSGDaddyChildIsOld } from \"./mrSGDaddyChildIsOld\";\nimport { mrSGDaddyChildNone } from \"./mrSGDaddyChildNone\";\nimport { mrSGDaddyLongNames } from \"./mrSGDaddyLongNames\";\nimport { mrSGDaddyManyChildren } from \"./mrSGDaddyManyChildren\";\nimport { mrPreschoolRegister } from \"./mrSGPreschoolRegister\";\nimport { mrSGDaddyMissingFields } from \"./mrSGDaddyMissingFields\";\nimport { mrSGDaddyMissingUneditableFields } from \"./mrSGDaddyMissingUneditableFields\";\nimport { mrPRDaddyOneChild } from \"./mrPRDaddyOneChild\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { mrsMYMommyPerfect } from \"./mrsMYMommyPerfect\";\nimport { mrsSGMommyPerfect } from \"./mrsSGMommyPerfect\";\nimport { mrMYDaddyPerfect } from \"./mrMYDaddyPerfect\";\n\n/**\n * Exhaustive list of our MyInfo archetype profiles\n */\nexport const profiles = [\n\tmrSGDaddyPerfect,\n\tmrsSGMommyPerfect,\n\tmrPRDaddyPerfect,\n\tmrsMYMommyPerfect,\n\tmrSGDaddyChildNone,\n\tmrPRDaddyOneChild,\n\tmrSGDaddyChildIsOld,\n\tmrSGDaddyManyChildren,\n\tmrPreschoolRegister,\n\tmrSGDaddyLongNames,\n\tmrSGDaddyMissingFields,\n\tmrSGDaddyMissingUneditableFields,\n\tmrMYDaddyPerfect,\n];\n","module.exports = require(\"moment\");","export const unavailableField: UnavailableField = {\n\tlastupdated: \"2018-05-10\",\n\tsource: \"1\",\n\tclassification: \"C\",\n\tunavailable: true,\n};\n\ninterface UnavailableField {\n\tclassification: \"C\";\n\tsource: \"1\" | \"2\" | \"3\" | \"4\";\n\tlastupdated: string; // date\n\tunavailable: boolean;\n}\n","import * as domain from \"./domain\";\nimport * as domainMap from \"./map\";\n\nexport { domain, domainMap };\n","import * as MyInfo from \"./myinfo\";\nimport * as Singpass from \"./singpass\";\n\nexport { MyInfo, Singpass };\n","export {\n\tMyInfoHelper as Helper, MyInfoHelperConstructor as HelperConstructor,\n\tMyInfoRequest as Request, MyInfoRequestConstructor as RequestConstructor,\n} from \"./helper\";\n\nimport * as Fake from \"./fake\";\nexport { Fake };\n\nexport * from \"./domain\";\n","import * as request from \"request\";\nimport { domain } from \"../domain\";\n\nexport interface IMyInfoHelper {\n\tgetPersonBasic: <K extends keyof domain.Components.Schemas.PersonBasic>(uinfin: string) => Promise<Pick<domain.Components.Schemas.PersonBasic, K>>;\n}\n\nexport interface IMyInfoRequest {\n\tget: (\n\t\turi: string,\n\t\tparams?: { [key: string]: any },\n\t\tbearer?: string,\n\t) => Promise<request.RequestResponse>;\n}\n\n\nexport * from \"./myinfo-helper\";\nexport * from \"./myinfo-request\";\n","import { AxiosResponse } from \"axios-https-proxy-fix\";\nimport * as _ from \"lodash\";\n\nimport { MyInfoRequest } from \"./myinfo-request\";\nimport { MyInfoRequestConstructor } from \"./myinfo-request\";\nimport { decryptJWE, verifyJWS } from \"../../util/JweUtil\";\nimport { IMyInfoHelper } from \"./index\";\nimport { domain } from \"../domain\";\n\nexport interface MyInfoHelperConstructor {\n\tattributes: string[];\n\tclientID: string;\n\tpersonBasicURL: string;\n\tsingpassEserviceID: string;\n\tkeyToDecryptJWE: string;\n\tcertToVerifyJWS?: string;\n\tprivateKeyToSignRequest: string;\n\tprivateKeyPassword?: string;\n}\n\nexport class MyInfoHelper implements IMyInfoHelper {\n\n\tprivate myInfoRequest: MyInfoRequest;\n\n\tprivate readonly attributes: string[];\n\tprivate readonly clientID: string;\n\tprivate readonly personBasicURL: string;\n\tprivate readonly singpassEserviceID: string;\n\tprivate readonly keyToDecryptJWE: string;\n\tprivate readonly certToVerifyJWS: string;\n\n\tpublic constructor(props: MyInfoHelperConstructor) {\n\t\tif (_.isEmpty(props.attributes)) {\n\t\t\tthrow new Error(\"Attribute list must contain values\");\n\t\t}\n\t\tthis.attributes = props.attributes;\n\t\tthis.clientID = props.clientID;\n\t\tthis.personBasicURL = props.personBasicURL;\n\t\tthis.singpassEserviceID = props.singpassEserviceID;\n\t\tthis.keyToDecryptJWE = props.keyToDecryptJWE;\n\t\tthis.certToVerifyJWS = props.certToVerifyJWS;\n\n\t\tconst requestProps: MyInfoRequestConstructor = {\n\t\t\tappId: props.clientID,\n\t\t\tprivateKeyToSignRequest: props.privateKeyToSignRequest,\n\t\t\tprivateKeyPassword: props.privateKeyPassword,\n\t\t};\n\t\tthis.myInfoRequest = new MyInfoRequest(requestProps);\n\t}\n\n\t/**\n\t * Obtain V3 person data using uinfin.\n\t * In the generic K, pass in the list of string literal of the attributes you expect to get back.\n\t * getPersonBasicV3 will return an object with only the properties matching the keys.\n\t * e.g. when K = \"name\" | \"email\", getPersonBasicV3 returns an object looking like { name, email }\n\t */\n\tpublic getPersonBasic = async<K extends keyof domain.Components.Schemas.PersonBasic>(uinfin: string): Promise<Pick<domain.Components.Schemas.PersonBasic, K>> => {\n\t\tconst url = `${this.personBasicURL}/${uinfin}`;\n\t\tconst params = {\n\t\t\tclient_id: this.clientID,\n\t\t\tsp_esvcId: this.singpassEserviceID,\n\t\t\tattributes: this.attributes.join(\",\"),\n\t\t};\n\n\t\tlet response: AxiosResponse;\n\t\ttry {\n\t\t\tresponse = await this.myInfoRequest.get(url, params);\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error requesting for person data (JWE) from MyInfo\", error);\n\t\t\tthrow error;\n\t\t}\n\n\t\ttry {\n\t\t\t// Decrypt person data\n\t\t\tconst encryptedPersonJWE = response.data;\n\t\t\tconst jwe = await decryptJWE(encryptedPersonJWE, this.keyToDecryptJWE);\n\t\t\tconst jws = JSON.parse(jwe.payload.toString());\n\t\t\tconst verifiedJws = await verifyJWS(jws, this.certToVerifyJWS);\n\t\t\tconst personData = JSON.parse(verifiedJws.payload.toString()) as Pick<domain.Components.Schemas.PersonBasic, K>;\n\n\t\t\tif (personData == null) {\n\t\t\t\tthrow new Error(\"Person data cannot be null\");\n\t\t\t}\n\n\t\t\treturn personData;\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error verifying person data from MyInfo\", error);\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n","module.exports = require(\"nonce\");","let displayWarnings = true;\n\nexport function disableMissingEnvWarnings() {\n\tdisplayWarnings = false;\n}\n\nexport function getValueFromEnv(key: string, defaultValue?: string): string {\n\tconst value = !!process.env[key] ? process.env[key].trim() : defaultValue;\n\tif (!value && displayWarnings) {\n\t\tconsole.warn(`Configuration key not found or empty: ${key}`);\n\t}\n\treturn value;\n}\n\nexport function getValueFromEnvWithoutWarn(key: string, defaultValue?: string): string {\n\tconst value = !!process.env[key] ? process.env[key].trim() : defaultValue;\n\treturn value;\n}\n\nexport function getIntValueFromEnv(key: string, defaultValue: number): number {\n\tconst stringValue = getValueFromEnv(key, null);\n\tif (!stringValue) {\n\t\treturn defaultValue;\n\t}\n\n\tconst intValue = parseInt(stringValue, 10);\n\tif (isNaN(intValue)) {\n\t\tif (displayWarnings) {\n\t\t\tconsole.warn(`Configuration ${key} is not a valid integer: ${stringValue}`);\n\t\t}\n\t\treturn defaultValue;\n\t}\n\n\treturn intValue;\n}\n\n\nexport function getBooleanValueFromEnv(key: string, defaultValue: boolean = false): boolean {\n\tconst stringValue = getValueFromEnv(key, null);\n\tif (!stringValue) {\n\t\treturn defaultValue;\n\t}\n\n\tif (stringValue !== \"true\" && stringValue !== \"false\") {\n\t\tconsole.warn(`Configuration ${key} is not a valid boolean: ${stringValue}`);\n\t}\n\n\treturn stringValue === \"true\";\n}\n","import * as isBase64 from \"is-base64\";\n\n\nexport function replaceLineBreaks(input: string): string {\n\tif (!input) {\n\t\treturn input;\n\t}\n\n\treturn input.replace(/\\\\n/g, \"\\n\");\n}\n\nexport function isBase64Valid(test: string): boolean {\n\treturn isBase64(test, { paddingRequired: false });\n}\n","module.exports = require(\"is-base64\");","declare var global: any;\n\n/**\n * @returns Whether the code is currently running in Jest or not\n */\nexport function isTest(): boolean {\n\treturn global.describe && global.it;\n}\n","import * as _ from \"lodash\";\nimport * as qs from \"querystring\";\nimport * as crypto from \"crypto\";\n\nexport enum HttpMethod {\n\tGET = \"GET\",\n\tPOST = \"POST\",\n}\n\ninterface AuthHeader {\n\tapp_id: string;\n\tnonce: number;\n\tsignature_method: string;\n\ttimestamp: number;\n\tsignature: string;\n}\n\n/**\n * Generate the Authorization header for requests to V3 MyInfo\n * @param url\n * @param queryParams\n * @param method\n * @param appId\n * @param signingKey\n * @param signingKeyPassphrase\n */\nexport function generateMyInfoAuthorizationHeader(\n\turl: string,\n\tqueryParams: { [key: string]: any },\n\tmethod: HttpMethod,\n\tappId: string,\n\tsigningKey: string,\n\tnonce?: number,\n\ttimestamp?: number,\n\tsigningKeyPassphrase?: string,\n) {\n\tconst authHeaderObj: Partial<AuthHeader> = {\n\t\tapp_id: appId, // App ID assigned to your application\n\t\tnonce, // secure random number\n\t\tsignature_method: \"RS256\",\n\t\ttimestamp, // Unix epoch time\n\t};\n\n\tconst signature = generateSignature(authHeaderObj, queryParams, method, url, signingKey, signingKeyPassphrase);\n\n\treturn generateAuthHeaderString(appId, nonce, signature, timestamp);\n}\n\nfunction generateAuthHeaderString(appId: string, nonceValue: any, signature: string, timestamp: number) {\n\treturn \"PKI_SIGN app_id=\\\"\" + appId + // Defaults to 1st part of incoming request hostname\n\t\t\"\\\",nonce=\\\"\" + nonceValue +\n\t\t\"\\\",signature_method=\\\"RS256\\\"\" +\n\t\t\",signature=\\\"\" + signature +\n\t\t\"\\\",timestamp=\\\"\" + timestamp +\n\t\t\"\\\"\";\n}\n\n/**\n * Function to generate signature for authenticated requests to myinfo v3\n * @param authHeader\n * @param queryParams\n * @param method\n * @param url\n * @param key\n * @param keyPassphrase\n */\nfunction generateSignature(\n\tauthHeader: Partial<AuthHeader>,\n\tqueryParams: { [key: string]: any; },\n\tmethod: HttpMethod,\n\turl: string,\n\tkey: string,\n\tkeyPassphrase?: string,\n): string {\n\tconst baseParams = _.merge(authHeader, queryParams);\n\tconst sortedListOfKeysForBaseString = [\"app_id\", \"attributes\", \"client_id\", \"nonce\", \"signature_method\", \"sp_esvcId\", \"timestamp\"];\n\n\tconst sortedParams = sortedListOfKeysForBaseString.reduce((object, prop) => {\n\t\treturn _.set(object, prop, baseParams[prop]);\n\t}, {});\n\n\tconst baseParamsStr = qs.unescape(qs.stringify(sortedParams)); // url safe\n\tconst baseString = method.toUpperCase() + \"&\" + url + \"&\" + baseParamsStr;\n\tconst signWith = { key };\n\tif (!!keyPassphrase) {\n\t\t_.set(signWith, \"passphrase\", keyPassphrase);\n\t}\n\n\tconst signature = crypto.createSign(\"RSA-SHA256\")\n\t\t.update(baseString)\n\t\t.sign(signWith, \"base64\");\n\n\treturn signature;\n}\n","module.exports = require(\"crypto\");","module.exports = require(\"node-jose\");","module.exports = require(\"axios-https-proxy-fix\");","module.exports = require(\"url\");","export const redactNricfinInString = (input: string): string => {\n\tconst indexOfNric = getIndexOfNricInString(input);\n\tif (indexOfNric !== -1) {\n\t\tconst nric = input.substr(indexOfNric, 9);\n\t\tconst redactedNric = redactNricfin(nric);\n\n\t\treturn input.replace(nric, redactedNric);\n\t}\n\n\treturn input;\n};\n\nexport const redactNricfin = (nricfin: string): string => {\n\tif (nricfin && isValidNricfin(nricfin)) {\n\t\tconst firstThreeDigits = nricfin.substring(1, 4);\n\t\treturn nricfin.replace(firstThreeDigits, \"***\");\n\t}\n\n\treturn nricfin;\n};\n\nconst isValidNricfin = (value) => {\n\tconst result = /[STFG]\\d{7}[A-Z]/i.exec(value);\n\treturn result;\n};\n\nconst getIndexOfNricInString = (value): number => {\n\tconst result = /[STFG]\\d{7}[A-Z]/i.exec(value);\n\tif (!!result) {\n\t\treturn result.index;\n\t}\n\treturn -1;\n};\n\n","export { FakeMyInfoHelper as Helper, IFakeMyInfoHelper as IHelper, MockParams } from \"./fake-helper\";\nexport { FakeMyInfoRequest as Request } from \"./fake-request\";\nexport * from \"./profiles/fake-profiles\";\nexport { ProfileArchetype } from \"./profiles/fake-profile\";\n","import { ProfileArchetype } from \"./profiles/fake-profile\";\nimport { profiles } from \"./profiles/fake-profiles\";\nimport { domain, domainMap } from \"../domain\";\nimport { isEmpty, toPairs } from \"lodash\";\n\nexport interface MockParams {\n\tarchetype: ProfileArchetype;\n\tmarital?: \"SINGLE\" | \"MARRIED\" | \"WIDOWED\" | \"DIVORCED\";\n\tmarriagedate?: string;\n\tmarriagecertno?: string;\n\tcountryofmarriage?: { desc: string, code: string };\n\toccupation?: string;\n\toccupationfreeform?: string;\n\tdob?: string;\n}\ntype PersonBasic = domain.Components.Schemas.PersonBasic;\n\nexport interface IFakeMyInfoHelper {\n\tgetPersonBasic: (mockParams: MockParams) => PersonBasic;\n}\n\nexport class FakeMyInfoHelper implements IFakeMyInfoHelper {\n\t/**\n\t * @param attributes attributes to return in the MyInfoPerson in getPersonData\n\t */\n\tpublic constructor(\n\t\tprivate readonly attributes?: ReadonlyArray<string>,\n\t) { }\n\n\t/**\n\t * fake getPersonData\n\t * @param input the mock profile parameters.\n\t * See FakeMyInfoPersonArchetypes for the actual person.\n\t */\n\tpublic getPersonBasic = (mockParams: MockParams): PersonBasic => {\n\t\tconst mockProfile = profiles.find((profile) => profile.name === mockParams.archetype);\n\t\tif (!mockProfile)\n\t\t\treturn null;\n\n\t\tconst myinfoPerson = {\n\t\t\t...mockProfile.generate(),\n\t\t};\n\n\t\tif (!isEmpty(mockParams.marital)) {\n\t\t\tmyinfoPerson.marital.desc = mockParams.marital;\n\n\t\t\tmyinfoPerson.marital.code = domainMap.sex.map.descToCode[mockParams.marital];\n\t\t}\n\n\t\tif (!isEmpty(mockParams.marriagedate)) {\n\t\t\tmyinfoPerson.marriagedate.value = mockParams.marriagedate;\n\t\t}\n\n\t\tif (!isEmpty(mockParams.marriagecertno)) {\n\t\t\tmyinfoPerson.marriagecertno.value = mockParams.marriagecertno;\n\t\t}\n\n\t\tif (!isEmpty(mockParams.countryofmarriage)) {\n\t\t\tmyinfoPerson.countryofmarriage.desc = mockParams.countryofmarriage.desc;\n\t\t\tmyinfoPerson.countryofmarriage.code = mockParams.countryofmarriage.code;\n\t\t}\n\n\t\tif (!isEmpty(mockParams.dob)) {\n\t\t\tmyinfoPerson.dob.value = mockParams.dob;\n\t\t}\n\n\t\tif (!isEmpty(mockParams.occupation)) {\n\t\t\tmyinfoPerson.occupation.value = mockParams.occupation;\n\t\t} else {\n\t\t\tif (!isEmpty(mockParams.occupationfreeform)) {\n\t\t\t\tmyinfoPerson.occupation.value = \"\";\n\t\t\t\tmyinfoPerson.occupation.desc = mockParams.occupationfreeform;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.attributes) {\n\t\t\treturn myinfoPerson;\n\t\t}\n\n\t\treturn filterThroughMyInfoAttributes(myinfoPerson, this.attributes);\n\t}\n}\n\n/**\n * @description Returns new fake person with only the attributes listed in attributes param. Does not mutate.\n * @param person fake MyInfo person\n * @param attributes array of attributes to filter for\n */\nfunction filterThroughMyInfoAttributes(person: PersonBasic, attributes: ReadonlyArray<string>): PersonBasic {\n\tconst attrs = new Set(attributes);\n\n\treturn toPairs(person)\n\t\t.filter(([k]) => attrs.has(k))\n\t\t.reduce((accumulator, [k, v]) => ({ ...accumulator, [k]: v }), {} as PersonBasic);\n}\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { residentialstatus } from \"../../domain/map\";\n\nconst id = \"S2599302J\";\nconst name = ProfileArchetype.MR_PR_DADDY_PERFECT;\n\nexport const mrPRDaddyPerfect: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.nationality.code = \"AD\";\n\t\tprofile.residentialstatus.code = \"P\";\n\t\tprofile.residentialstatus.desc = residentialstatus.map.codeToDesc[profile.residentialstatus.code];\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { ChildrenRecords } from \"./childbirthRecords\";\n\nconst id = \"T2446959F\";\nconst name = ProfileArchetype.MR_SG_DADDY_CHILD_IS_OLD;\n\nexport const mrSGDaddyChildIsOld: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.childrenbirthrecords = [ChildrenRecords.childSuperOld];\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\n\nconst id = \"T2446959F\";\nconst name = ProfileArchetype.MR_SG_DADDY_CHILD_NONE;\n\nexport const mrSGDaddyChildNone: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.childrenbirthrecords = [];\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { ChildrenRecords } from \"./childbirthRecords\";\n\nconst id = \"T2446959F\";\nconst name = ProfileArchetype.MR_SG_DADDY_LONG_NAMES;\n\nexport const mrSGDaddyLongNames: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tconst longName = \"Princess Aura Nurr Ermily Amara Auliya Bidadari S/O (Nawal), El@Bjrk' Mara-Jose!\";\n\t\tprofileName = _.isEmpty(profileName) ? longName : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.childrenbirthrecords = _.values(ChildrenRecords);\n\t\tprofile.childrenbirthrecords[0].name.value = longName + \" JR\";\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { ChildrenRecords } from \"./childbirthRecords\";\n\n\nconst id = \"T2446959F\";\nconst name = ProfileArchetype.MR_SG_DADDY_MANY_CHILDREN;\n\nexport const mrSGDaddyManyChildren: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.childrenbirthrecords = _.values(ChildrenRecords);\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport * as moment from \"moment\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { domain } from \"../../domain\";\n\n\nconst id = \"S0350934F\";\nconst name = ProfileArchetype.MR_SG_PRESCHOOL_CHILDREN;\n\nexport const mrPreschoolRegister: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.childrenbirthrecords = _.values(ChildrenRecords);\n\n\t\treturn profile;\n\t},\n};\n\nconst formatDateToString = (date?: moment.Moment): string => {\n\tif (date) {\n\t\treturn date.format(\"YYYY-MM-DD\").toString();\n\t}\n\treturn moment().format(\"YYYY-MM-DD\").toString();\n};\n\n// the children here have birthcertno related to the preschool interest registration mock\nconst c1 = {\n\tbirthcertno: { value: \"T1639540J\" },\n\tname: { value: \"Child w level not offered\" },\n\tdob: { value: formatDateToString(moment().subtract(2, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst c2 = {\n\tbirthcertno: { value: \"T1717003H\" },\n\tname: { value: \"Child w ineligible\" },\n\tdob: { value: formatDateToString(moment().subtract(2, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst c3 = {\n\tbirthcertno: { value: \"T1728256A\" },\n\tname: { value: \"Child w registered\" },\n\tdob: { value: formatDateToString(moment().subtract(3, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst c4 = {\n\tbirthcertno: { value: \"T1766863Z\" },\n\tname: { value: \"Child w nothing\" },\n\tdob: { value: formatDateToString(moment().subtract(4, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst c5 = {\n\tbirthcertno: { value: \"T1783246D\" },\n\tname: { value: \"Child2 w level not offered \" },\n\tdob: { value: formatDateToString(moment().subtract(5, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nconst c6 = {\n\tbirthcertno: { value: \"T1790160A\" },\n\tname: { value: \"Child2 w ineligible\" },\n\tdob: { value: formatDateToString(moment().subtract(6, \"years\")) },\n} as domain.Components.Schemas.Childrenbirthrecords;\n\nexport const ChildrenRecords = {\n\tc1, c2, c3, c4, c5, c6,\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { unavailableField } from \"./common\";\n\n\nconst id = \"S8779834H\";\nconst name = ProfileArchetype.MR_SG_DADDY_MISSING_FIELDS;\n\nexport const mrSGDaddyMissingFields: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.hanyupinyinname = unavailableField;\n\t\tprofile.aliasname = unavailableField;\n\t\tprofile.hanyupinyinaliasname = unavailableField;\n\t\tprofile.secondaryrace = unavailableField;\n\t\tprofile.residentialstatus = unavailableField;\n\t\tprofile.homeno = unavailableField;\n\t\tprofile.marriagecertno = unavailableField;\n\t\tprofile.countryofmarriage = unavailableField;\n\t\tif (!!profile.childrenbirthrecords) {\n\t\t\tprofile.childrenbirthrecords = profile.childrenbirthrecords.slice(0, 1);\n\t\t}\n\t\tprofile.edulevel = unavailableField;\n\t\tprofile.occupation = unavailableField;\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { unavailableField } from \"./common\";\n\n\nconst id = \"S8974352D\";\nconst name = ProfileArchetype.MR_SG_DADDY_MISSING_UNEDITABLE_FIELDS;\n\nexport const mrSGDaddyMissingUneditableFields: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\n\t\t// Uneditable field\n\t\tprofile.nationality = unavailableField;\n\t\tprofile.dob = unavailableField;\n\t\tprofile.regadd = unavailableField;\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { ChildrenRecords } from \"./childbirthRecords\";\nimport { residentialstatus } from \"../../domain/map\";\n\nconst id = \"S7936715Z\";\nconst name = ProfileArchetype.MR_PR_DADDY_ONE_CHILD;\n\nexport const mrPRDaddyOneChild: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.residentialstatus.code = \"P\";\n\t\tprofile.residentialstatus.desc = residentialstatus.map.codeToDesc[profile.residentialstatus.code];\n\n\t\tprofile.childrenbirthrecords = [ChildrenRecords.childYoungest];\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { residentialstatus, sex } from \"../../domain/map\";\n\n\nconst id = \"F5994458N\";\nconst name = ProfileArchetype.MRS_MY_MOMMY_PERFECT;\n\nexport const mrsMYMommyPerfect: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\n\t\tprofile.sex.code = \"F\";\n\t\tprofile.sex.desc = sex.map.codeToDesc[profile.sex.code];\n\n\t\tprofile.nationality.code = \"MY\";\n\t\tprofile.birthcountry.code = \"MY\";\n\n\t\tprofile.residentialstatus.code = \"A\";\n\t\tprofile.residentialstatus.desc = residentialstatus.map.codeToDesc[profile.residentialstatus.code];\n\n\t\tprofile.passportnumber.value = \"A00000000\";\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { sex } from \"../../domain/map\";\n\n\nconst id = \"T2446959F\";\nconst name = ProfileArchetype.MRS_SG_MOMMY_PERFECT;\n\nexport const mrsSGMommyPerfect: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\n\t\tprofile.sex.code = \"F\";\n\t\tprofile.sex.desc = sex.map.codeToDesc[profile.sex.code];\n\n\t\treturn profile;\n\t},\n};\n","import * as _ from \"lodash\";\nimport { FakeProfile, ProfileArchetype } from \"./fake-profile\";\nimport { mrSGDaddyPerfect } from \"./mrSGDaddyPerfect\";\nimport { residentialstatus, sex } from \"../../domain/map\";\n\nconst id = \"F5994458N\";\nconst name = ProfileArchetype.MR_MY_DADDY_PERFECT;\n\nexport const mrMYDaddyPerfect: FakeProfile = {\n\tid,\n\tname,\n\tgenerate: (profileName) => {\n\t\tprofileName = _.isEmpty(profileName) ? name : profileName;\n\n\t\tconst profile = mrSGDaddyPerfect.generate(profileName);\n\t\tprofile.sex.code = \"M\";\n\t\tprofile.sex.desc = sex.map.codeToDesc[profile.residentialstatus.code];\n\t\tprofile.nationality.code = \"MY\";\n\t\tprofile.birthcountry.code = \"MY\";\n\t\tprofile.residentialstatus.code = \"A\";\n\t\tprofile.residentialstatus.desc = residentialstatus.map.codeToDesc[profile.residentialstatus.code];\n\t\tprofile.passportnumber.value = \"A00000000\";\n\n\t\treturn profile;\n\t},\n};\n","import * as request from \"request\";\nimport { IMyInfoRequest } from \"../helper\";\n\nexport class FakeMyInfoRequest implements IMyInfoRequest {\n\tconstructor() {\n\t}\n\n\tpublic async get(\n\t\texpectedResponse: any,\n\t): Promise<request.RequestResponse> {\n\t\treturn expectedResponse;\n\t}\n\n\tpublic async postForm(\n\t\texpectedResponse: any,\n\t): Promise<request.RequestResponse> {\n\t\treturn expectedResponse;\n\t}\n}\n","export * from \"./singpass-helper\";\n","import * as querystringUtil from \"querystring\";\nimport { createClient } from \"../client\";\nimport { JweUtil } from \"../util\";\nimport { AxiosInstance, AxiosRequestConfig } from \"axios-https-proxy-fix\";\n\nexport enum SessionRefreshResult {\n\tSUCCESS = \"SUCCESS\",\n\tSINGPASS_ERROR = \"SINGPASS_ERROR\",\n\tINVALID_SESSION_ID = \"INVALID_SESSION_ID\",\n}\n\nexport enum SessionLogoutResult {\n\tSUCCESS = \"SUCCESS\",\n\tSINGPASS_ERROR = \"SINGPASS_ERROR\",\n}\n\nexport interface TokenResponse {\n\taccess_token: string;\n\trefresh_token: string;\n\tid_token: string;\n\ttoken_type: string;\n\texpires_in: number;\n\tscope: string;\n}\n\nexport interface TokenPayload {\n\trt_hash: string;\n\tnonce?: string;\n\tiat: number;\n\tiss: string;\n\tat_hash: string;\n\t// sub contains user's NRIC and UUID: s=S1234567A,u=f19fdf4c-f57b-40b5-a8e0-6fb6eef640e3\n\tsub: string;\n\texp: number;\n\taud: string;\n\tamr: string[];\n}\n\nexport interface OidcHelperConstructor {\n\tauthorizationUrl: string;\n\tlogoutUrl: string;\n\ttokenUrl: string;\n\tclientID: string;\n\tclientSecret: string;\n\tredirectUri: string;\n\tjweDecryptKey: string;\n\tjwsVerifyKey: string;\n}\n\nexport class OidcHelper {\n\n\tprivate SINGPASS_SESSION_COOKIE_NAME = \"PD-S-SESSION-ID\";\n\tprivate axiosClient: AxiosInstance = createClient({\n\t\ttimeout: 10000,\n\t});\n\n\tprivate authorizationUrl: string;\n\tprivate logoutUrl: string;\n\tprivate tokenUrl: string;\n\tprivate clientID: string;\n\tprivate clientSecret: string;\n\tprivate redirectUri: string;\n\tprivate jweDecryptKey: string;\n\tprivate jwsVerifyKey: string;\n\n\n\tconstructor(props: OidcHelperConstructor) {\n\t\tthis.authorizationUrl = props.authorizationUrl;\n\t\tthis.logoutUrl = props.logoutUrl;\n\t\tthis.tokenUrl = props.tokenUrl;\n\t\tthis.clientID = props.clientID;\n\t\tthis.clientSecret = props.clientSecret;\n\t\tthis.redirectUri = props.redirectUri;\n\t\tthis.jweDecryptKey = props.jweDecryptKey;\n\t\tthis.jwsVerifyKey = props.jwsVerifyKey;\n\t}\n\n\tpublic constructAuthorizationUrl = (\n\t\tstate: string,\n\t\tnonce?: string,\n\t): string => {\n\t\tconst queryParams = {\n\t\t\tstate,\n\t\t\t...(nonce ? { nonce } : {}),\n\t\t\tredirect_uri: this.redirectUri,\n\t\t\tscope: \"openid\",\n\t\t\tclient_id: this.clientID,\n\t\t\tresponse_type: \"code\",\n\n\t\t};\n\t\tconst queryString = querystringUtil.stringify(queryParams);\n\t\treturn `${this.authorizationUrl}?${queryString}`;\n\t}\n\n\t/**\n\t * Get tokens from Singpass endpoint. Note: This will fail if not on an IP whitelisted by SP.\n\t * Use getIdTokenPayload on returned Token Response to get the token payload\n\t */\n\tpublic getTokens = async (authCode: string, axiosRequestConfig?: AxiosRequestConfig): Promise<TokenResponse> => {\n\t\tconst params = {\n\t\t\tgrant_type: \"authorization_code\",\n\t\t\tcode: authCode,\n\t\t\tclient_id: this.clientID,\n\t\t\tclient_secret: this.clientSecret,\n\t\t\tredirect_uri: this.redirectUri,\n\t\t};\n\t\tconst body = querystringUtil.stringify(params);\n\n\t\tconst config = {\n\t\t\theaders: { \"content-type\": \"application/x-www-form-urlencoded\" },\n\t\t\t...axiosRequestConfig,\n\t\t};\n\t\tconst response = await this.axiosClient.post(this.tokenUrl, body, config);\n\t\tif (!response.data.id_token) {\n\t\t\tconsole.error(\"Failed to get ID token: invalid response data\", response.data);\n\t\t\tthrow new Error(\"Failed to get ID token\");\n\t\t}\n\t\treturn response.data;\n\t}\n\n\t/**\n\t * Decrypts the ID Token JWT inside the TokenResponse to get the payload\n\t * Use extractNricAndUuidFromPayload on the returned Token Payload to get the NRIC and UUID\n\t */\n\tpublic async getIdTokenPayload(tokens: TokenResponse): Promise<TokenPayload> {\n\t\ttry {\n\n\t\t\tconst { id_token } = tokens;\n\t\t\tconst decryptedJwe = await JweUtil.decryptJWE(id_token, this.jweDecryptKey);\n\t\t\tconst jwsPayload = decryptedJwe.payload.toString();\n\t\t\tconst verifiedJws = await JweUtil.verifyJWS(jwsPayload, this.jwsVerifyKey);\n\t\t\treturn JSON.parse(verifiedJws.payload.toString()) as TokenPayload;\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to get token payload\", e);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\t/**\n\t * Returns the nric and uuid from the token payload\n\t */\n\tpublic extractNricAndUuidFromPayload(payload: TokenPayload): { nric: string, uuid: string } {\n\t\tconst { sub } = payload;\n\n\t\tif (sub) {\n\t\t\tconst extractionRegex = /s=([STFG]\\d{7}[A-Z]).*,u=(.*)/i;\n\t\t\tconst matchResult = sub.match(extractionRegex);\n\n\t\t\tif (!matchResult) {\n\t\t\t\tthrow Error(\"Token payload sub property is invalid, does not contain valid NRIC and uuid string\");\n\t\t\t}\n\n\t\t\tconst nric = matchResult[1];\n\t\t\tconst uuid = matchResult[2];\n\n\t\t\treturn { nric, uuid };\n\t\t}\n\n\t\tthrow Error(\"Token payload sub property is not defined\");\n\t}\n\n\t/**\n\t * [DEPRECATED] Refresh the Singpass session, using a valid session id (that is retrieved from Singpass domain cookie)\n\t * @param sessionId the session id extracted from PD-S-SESSION-ID in the user agent\n\t * @param state state that will be passed to the your redirect uri from this refresh call. defaults to \"dummyState\"\n\t * @returns INVALID_SESSION_ID - the sessionId param is no longer valid\n\t * @returns SINGPASS_ERROR - the call to Singpass server to refresh is not successful\n\t * @returns SUCCESS - refresh sessionId successfully\n\t */\n\tpublic async refreshSession(sessionId: string, state: string = \"dummyState\"): Promise<SessionRefreshResult> {\n\t\tconst authorizationUrl = this.constructAuthorizationUrl(state);\n\t\tconst requestConfig = { headers: { Cookie: `${this.SINGPASS_SESSION_COOKIE_NAME}=${sessionId}` } };\n\t\ttry {\n\t\t\tconst result = await this.axiosClient.get(authorizationUrl, requestConfig);\n\t\t\tif (result.request.res.responseUrl.includes(\"saml.singpass.gov.sg\")) {\n\t\t\t\tconsole.warn(`Attempted to refresh session with invalid session ID ${sessionId}`);\n\t\t\t\treturn SessionRefreshResult.INVALID_SESSION_ID;\n\t\t\t}\n\t\t\treturn SessionRefreshResult.SUCCESS;\n\t\t} catch (e) {\n\t\t\tconsole.warn(`Singpass Error while attempting to refresh session for sessionId: ${sessionId}\\nError:`, e);\n\t\t\treturn SessionRefreshResult.SINGPASS_ERROR;\n\t\t}\n\t}\n\n\n\n\t/**\n\t * [DEPRECATED] Log user out of Singpass, using a valid session id (that is retrieved from Singpass domain cookie)\n\t * @param sessionId the session id extracted from PD-S-SESSION-ID in the user agent\n\t */\n\tpublic async logoutOfSession(sessionId: string): Promise<SessionLogoutResult> {\n\t\tconst requestConfig = { headers: { Cookie: `${this.SINGPASS_SESSION_COOKIE_NAME}=${sessionId}` } };\n\t\ttry {\n\t\t\tawait this.axiosClient.get(this.logoutUrl, requestConfig);\n\t\t\treturn SessionLogoutResult.SUCCESS;\n\t\t} catch (e) {\n\t\t\tconsole.warn(\"Singpass Error while attempting to logout of Singpass session\", e);\n\t\t\treturn SessionLogoutResult.SINGPASS_ERROR;\n\t\t}\n\t}\n\n\tpublic _testExports = {\n\t\tsingpassClient: this.axiosClient,\n\t};\n}\n"],"sourceRoot":""}